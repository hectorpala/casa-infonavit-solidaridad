<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Casa en Venta ${{PRECIO}} - {{UBICACION}} | Hector es Bienes Raíces</title>
    <meta name="description" content="{{DESCRIPCION_CORTA}}">
    <meta name="keywords" content="casa venta Culiacán, {{UBICACION}}, {{RECAMARAS}} recámaras">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://casasenventa.info/culiacan/{{SLUG}}/">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="../../favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">

    <!-- PWA -->
    <meta name="theme-color" content="#ff4e00">
    <link rel="manifest" href="../../manifest.json">

    <!-- Open Graph -->
    <meta property="og:title" content="Casa en Venta ${{PRECIO}} - {{UBICACION}}">
    <meta property="og:url" content="https://casasenventa.info/culiacan/{{SLUG}}/">
    <meta property="og:image" content="https://casasenventa.info/culiacan/{{SLUG}}/images/foto-1.jpg">

    <!-- Schema.org -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SingleFamilyResidence",
      "name": "{{TITULO}}",
      "url": "https://casasenventa.info/culiacan/{{SLUG}}/",
      "image": [{{SCHEMA_IMAGES}}],
      "address": {
        "@type": "PostalAddress",
        "streetAddress": "{{UBICACION}}",
        "addressLocality": "Culiacán",
        "addressRegion": "Sinaloa",
        "addressCountry": "MX"
      },
      "floorSize": {"@type": "QuantitativeValue", "value": {{AREA_TERRENO}}, "unitCode": "MTK"},
      "numberOfBedrooms": {{RECAMARAS}},
      "numberOfBathroomsTotal": {{BANOS}},
      "offers": {"@type": "Offer", "price": "{{PRECIO_SIN_COMAS}}", "priceCurrency": "MXN"}
    }
    </script>

    <link rel="preload" href="../../styles.css" as="style">
    <link rel="stylesheet" href="../../styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;900&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">

    <style>
        .hero-image .carousel-wrapper { position: relative !important; overflow: hidden !important; }
        .hero-image .carousel-slide { position: absolute !important; top: 0 !important; left: 0 !important; width: 100% !important; height: 100% !important; opacity: 0 !important; transition: opacity 0.5s ease !important; }
        .hero-image .carousel-slide.active { opacity: 1 !important; z-index: 1 !important; }
        .hero-image .carousel-arrow { background: rgba(255, 78, 0, 0.9) !important; color: white !important; width: 50px !important; height: 50px !important; border-radius: 50% !important; z-index: 10 !important; }
    </style>
</head>
<body>

    <!-- Hero Carrusel -->
    <section class="hero-image">
        <div class="carousel-wrapper">
{{CAROUSEL_SLIDES}}
            <button class="carousel-arrow carousel-prev" onclick="changeSlideHero(-1); openLightboxFromCarousel();"><i class="fas fa-chevron-left"></i></button>
            <button class="carousel-arrow carousel-next" onclick="changeSlideHero(1); openLightboxFromCarousel();"><i class="fas fa-chevron-right"></i></button>
            <div class="carousel-dots">{{CAROUSEL_DOTS}}</div>
        </div>
        <div class="hero-overlay">
            <div class="description-box">
                <h1>{{TITULO}}</h1>
                <p class="subtitle">{{UBICACION}}</p>
                <p class="price">${{PRECIO}} MXN</p>
                <a href="https://wa.me/526677093648?text=Hola,%20me%20interesa%20{{TITULO_URL}}" class="cta-button" target="_blank">
                    <i class="fab fa-whatsapp"></i> Contactar por WhatsApp
                </a>
            </div>
        </div>
    </section>

    <!-- Sticky Price -->
    <div class="sticky-price-bar" id="stickyPriceBar">
        <div class="container-sticky">
            <span class="sticky-price">${{PRECIO}}</span>
            <a href="https://wa.me/526677093648?text=Hola,%20me%20interesa%20{{TITULO_URL}}" class="sticky-whatsapp" target="_blank">
                <i class="fab fa-whatsapp"></i><span class="sticky-whatsapp-text">Contactar</span>
            </a>
        </div>
    </div>

    <!-- Features -->
    <section class="features scroll-animate">
        <div class="container">
            <div class="features-grid">
                <div class="feature-card"><i class="fas fa-bed"></i><h3>{{RECAMARAS}}</h3><p>Recámaras</p></div>
                <div class="feature-card"><i class="fas fa-bath"></i><h3>{{BANOS}}</h3><p>Baños</p></div>
                <div class="feature-card"><i class="fas fa-ruler-combined"></i><h3>{{AREA_CONSTRUIDA}}m²</h3><p>Construcción</p></div>
                <div class="feature-card"><i class="fas fa-vector-square"></i><h3>{{AREA_TERRENO}}m²</h3><p>Terreno</p></div>
                <div class="feature-card"><i class="fas fa-car"></i><h3>{{ESTACIONAMIENTOS}}</h3><p>Estacionamientos</p></div>
                <div class="feature-card"><i class="fas fa-building"></i><h3>{{NIVELES}}</h3><p>{{NIVELES_TEXTO}}</p></div>
            </div>
        </div>
    </section>

    <!-- Description -->
    <section class="description scroll-animate">
        <div class="container">
            <h2 class="section-title">Descripción de la Propiedad</h2>
            <div class="description-content"><p>{{DESCRIPCION_HTML}}</p></div>
        </div>
    </section>

    <!-- Calculator -->
    <section class="calculator scroll-animate">
        <div class="container">
            <h2 class="section-title">Calculadora de Hipoteca</h2>
            <div class="calculator-container">
                <div class="calculator-input-group">
                    <label for="precio">Precio de la Propiedad</label>
                    <input type="number" id="precio" value="{{PRECIO_SIN_COMAS}}" step="1000">
                </div>
                <div class="calculator-input-group">
                    <label for="enganche">Enganche (%)</label>
                    <input type="range" id="enganche" min="0" max="50" value="20" step="5">
                    <span id="engancheDisplay">20% = ${{ENGANCHE_20}}</span>
                </div>
                <div class="calculator-input-group">
                    <label for="plazo">Plazo (años)</label>
                    <select id="plazo">
                        <option value="5">5 años</option>
                        <option value="10">10 años</option>
                        <option value="15">15 años</option>
                        <option value="20" selected>20 años</option>
                        <option value="25">25 años</option>
                        <option value="30">30 años</option>
                    </select>
                </div>
                <div class="calculator-input-group">
                    <label for="interes">Tasa de Interés Anual (%)</label>
                    <input type="range" id="interes" min="5" max="15" value="10.5" step="0.5">
                    <span id="interesDisplay">10.5%</span>
                </div>
                <div class="calculator-result">
                    <h3>Pago Mensual Estimado</h3>
                    <p class="monthly-payment" id="pagoMensual">$0</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact -->
    <section class="contact scroll-animate">
        <div class="container">
            <h2 class="section-title">¿Interesado en esta propiedad?</h2>
            <p class="contact-subtitle">Contáctanos para agendar una visita</p>
            <div class="contact-buttons">
                <a href="https://wa.me/526677093648?text=Hola,%20me%20interesa%20{{TITULO_URL}}" class="contact-button whatsapp" target="_blank">
                    <i class="fab fa-whatsapp"></i> WhatsApp
                </a>
                <a href="tel:+526677093648" class="contact-button phone"><i class="fas fa-phone"></i> Llamar</a>
            </div>
        </div>
    </section>

    <!-- WhatsApp Float -->
    <a href="https://wa.me/526677093648?text=Hola,%20me%20interesa%20{{TITULO_URL}}" class="whatsapp-float" target="_blank">
        <i class="fab fa-whatsapp"></i>
    </a>

    <!-- Lightbox -->
    <div id="lightbox" class="lightbox">
        <button class="lightbox-close" onclick="closeLightbox()">&times;</button>
        <button class="lightbox-arrow lightbox-prev" onclick="changeLightboxImage(-1)"><i class="fas fa-chevron-left"></i></button>
        <img id="lightbox-img" src="" alt="Imagen ampliada">
        <button class="lightbox-arrow lightbox-next" onclick="changeLightboxImage(1)"><i class="fas fa-chevron-right"></i></button>
        <div class="lightbox-counter" id="lightbox-counter"></div>
    </div>

    <script>
        let currentSlideHero = 0;
        const totalSlidesHero = {{TOTAL_FOTOS}};

        function changeSlideHero(direction) {
            const slides = document.querySelectorAll('.hero-image .carousel-slide');
            const dots = document.querySelectorAll('.hero-image .carousel-dot');
            slides[currentSlideHero].classList.remove('active');
            dots[currentSlideHero].classList.remove('active');
            currentSlideHero = (currentSlideHero + direction + totalSlidesHero) % totalSlidesHero;
            slides[currentSlideHero].classList.add('active');
            dots[currentSlideHero].classList.add('active');
            if ('vibrate' in navigator) navigator.vibrate(40);
        }

        document.querySelectorAll('.hero-image .carousel-dot').forEach((dot, index) => {
            dot.addEventListener('click', () => {
                const slides = document.querySelectorAll('.hero-image .carousel-slide');
                const dots = document.querySelectorAll('.hero-image .carousel-dot');
                slides[currentSlideHero].classList.remove('active');
                dots[currentSlideHero].classList.remove('active');
                currentSlideHero = index;
                slides[currentSlideHero].classList.add('active');
                dots[currentSlideHero].classList.add('active');
            });
        });

        setInterval(() => changeSlideHero(1), 5000);

        const lightboxImages = [{{LIGHTBOX_ARRAY}}];
        let currentLightboxIndex = 0;

        function openLightbox(index) {
            currentLightboxIndex = index;
            updateLightboxImage();
            document.getElementById('lightbox').style.display = 'flex';
            document.body.style.overflow = 'hidden';
            if ('vibrate' in navigator) navigator.vibrate(50);
        }

        function openLightboxFromCarousel() { openLightbox(currentSlideHero); }
        function closeLightbox() {
            document.getElementById('lightbox').style.display = 'none';
            document.body.style.overflow = 'auto';
        }

        function changeLightboxImage(direction) {
            currentLightboxIndex = (currentLightboxIndex + direction + lightboxImages.length) % lightboxImages.length;
            updateLightboxImage();
            if ('vibrate' in navigator) navigator.vibrate(40);
        }

        function updateLightboxImage() {
            document.getElementById('lightbox-img').src = lightboxImages[currentLightboxIndex];
            document.getElementById('lightbox-counter').textContent = `${currentLightboxIndex + 1} / ${lightboxImages.length}`;
        }

        document.addEventListener('keydown', (e) => {
            const lightbox = document.getElementById('lightbox');
            if (lightbox.style.display === 'flex') {
                if (e.key === 'ArrowLeft') changeLightboxImage(-1);
                if (e.key === 'ArrowRight') changeLightboxImage(1);
                if (e.key === 'Escape') closeLightbox();
            }
        });

        window.addEventListener('scroll', () => {
            const stickyBar = document.getElementById('stickyPriceBar');
            if (window.scrollY > 600) stickyBar.classList.add('visible');
            else stickyBar.classList.remove('visible');
        });

        function calcularHipoteca() {
            const precio = parseFloat(document.getElementById('precio').value);
            const enganchePorcentaje = parseFloat(document.getElementById('enganche').value);
            const plazoAnios = parseFloat(document.getElementById('plazo').value);
            const tasaAnual = parseFloat(document.getElementById('interes').value);
            const enganche = precio * (enganchePorcentaje / 100);
            const monto = precio - enganche;
            const tasaMensual = tasaAnual / 100 / 12;
            const plazoMeses = plazoAnios * 12;
            const pagoMensual = monto * (tasaMensual * Math.pow(1 + tasaMensual, plazoMeses)) / (Math.pow(1 + tasaMensual, plazoMeses) - 1);
            document.getElementById('pagoMensual').textContent = '$' + Math.round(pagoMensual).toLocaleString() + ' MXN';
            document.getElementById('engancheDisplay').textContent = enganchePorcentaje + '% = $' + Math.round(enganche).toLocaleString();
            document.getElementById('interesDisplay').textContent = tasaAnual + '%';
            if ('vibrate' in navigator) navigator.vibrate(30);
        }

        document.getElementById('precio').addEventListener('input', calcularHipoteca);
        document.getElementById('enganche').addEventListener('input', calcularHipoteca);
        document.getElementById('plazo').addEventListener('change', calcularHipoteca);
        document.getElementById('interes').addEventListener('input', calcularHipoteca);
        calcularHipoteca();

        const observerOptions = { threshold: 0.1, rootMargin: '0px 0px -50px 0px' };
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                    if ('vibrate' in navigator) navigator.vibrate(20);
                }
            });
        }, observerOptions);
        document.querySelectorAll('.scroll-animate').forEach(el => observer.observe(el));
    </script>
</body>
</html>
